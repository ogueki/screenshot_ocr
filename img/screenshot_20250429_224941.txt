```
# Tesseract の設定
pytesseract.pytesseract.tesseract_cmd = TESSERACT_CMD
import os
os.environ["TESSDATA_PREFIX"] = TESSDATA_PREFIX

def capture_and_ocr(img: Image.Image, mode: str) -> str:
    if mode == "high" and not os.getenv("OPENAI_API_KEY"):
        raise RuntimeError("OpenAI API キーが設定されていないため、高機能モードは使用できません")
    return ocr_high(img) if mode == "high" else ocr_normal(img)

def ocr_normal(img: Image.Image) -> str:
    gray = img.convert("L")
    contrast = ImageEnhance.Contrast(gray).enhance(CONTRAST_FACTOR)
    return pytesseract.image_to_string(contrast, lang="jpn+eng")

def ocr_high(img: Image.Image) -> str:
```

```
ファイル(F) 編集(E) 選択(R) 表示(V) 移動(G)
エクスプローラー
未変更 (ワークスペース)
スクリプトtext保存
> __pycache__
img
config.py
gui_app.py
main.py
ocr_utils.py 3
saver.py

アウトライン  タイムライン

問題  解決  出力  ターミナル  Python

Traceback (most recent call last):
  File "C:\Users\shinya\OneDrive\ドキュメント\スクリプトtext保存\main.py", line 19, in <module>
      app = OCRGui(api_key_available=api_key_available)
  File "C:\Users\shinya\OneDrive\ドキュメント\スクリプトtext保存\gui_app.py", line 49, in __init__
      tk.Button(self.root, text="終了", command=self.quit_all).pack(side="center")
  File "C:\Users\shinya\AppData\Local\Programs\Python\Python311\Lib\tkinter\__init__.py", line 2425, in pack_configure
      self.tk.call(
_tkinter.TclError: bad side "center": must be top, bottom, left, or right
PS C:\Users\shinya\OneDrive\ドキュメント\スクリプトtext保存>
PS C:\Users\shinya\OneDrive\ドキュメント\スクリプトtext保存> python main.py
PS C:\Users\shinya\OneDrive\ドキュメント\スクリプトtext保存>

[✓] img\screenshot_20250429_224904.png
[x] img\screenshot_20250429_224904.png

エクスプローラー の表示

お使いのシステムには Windows Subsystem for Linux (WSL) がインストールされていない
このソフトウェア用のおすすめ拡張機能'WSL" 拡張機能 提供元: Microsoft をインストールしますか？

インストール     推奨事項の表示

翻訳力を表示
無料で無制限アクセス、チーム機能など
```